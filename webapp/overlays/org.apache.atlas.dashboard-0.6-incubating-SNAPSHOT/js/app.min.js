'use strict';angular.module("dgc","ngCookies ngResource ui.bootstrap ui.router dgc.system dgc.home dgc.about dgc.search dgc.navigation dgc.tags dgc.tags.instance dgc.tags.definition".split(" "));angular.module("dgc.system",["dgc.system.notification"]);
angular.module("dgc").factory("lodash",["$window",function(a){return a._}]).factory("d3",["$window",function(a){return a.d3}]).factory("Global",["$window","$location",function(a,b){return{user:b.search()["user.name"],authenticated:!!a.user,renderErrors:a.renderErrors}}]).factory("HttpInterceptor",["Global",function(a){return{request:function(b){!b.url||0!==b.url.indexOf("api/atlas/")&&0!==b.url.indexOf("/api/atlas/")||(b.params=b.params||{},b.params["user.name"]=a.user);return b}}}]).config(["$httpProvider",
function(a){a.interceptors.push("HttpInterceptor")}]).run(["$rootScope","Global","NotificationService","lodash","d3",function(a,b,e,g,h){b=b.renderErrors;angular.isArray(b)||angular.isObject(b)?g.forEach(b,function(a){a=angular.isObject(a)?a:{message:a};a.timeout=!1;e.error(a)}):b&&(b.timeout=!1,e.error(b));a.$on("$stateChangeStart",function(){h.selectAll(".d3-tip").remove()})}]);angular.module("dgc").config(["$locationProvider","$urlRouterProvider",function(a,b){a.hashPrefix("!");b.otherwise("/search")}]);angular.module("dgc.about",[]);angular.module("dgc.details",["dgc.lineage"]);angular.module("dgc.home",[]);angular.module("dgc.lineage",[]);angular.module("dgc.navigation",[]);angular.module("dgc.system.notification",["ui.router"]).constant("ColorCoding",{info:"success",error:"danger"}).run(["$rootScope","NotificationService",function(a,b){a.$on("$locationChangeSuccess",function(a,g,h){g!==h&&b.reset()})}]);angular.module("dgc.search",["dgc.details"]);angular.module("dgc.tags.definition",[]);angular.module("dgc.tags.instance",[]);angular.module("dgc.tags",["dgc.details"]);angular.module("dgc.about").controller("AboutController",["$scope","AboutResource",function(a,b){b.get(function(b){a.versionInfo=b})}]);angular.module("dgc.about").factory("AboutResource",["$resource",function(a){return a("/api/atlas/admin/version",{})}]);angular.module("dgc.details").controller("DetailsController",["$window","$scope","$stateParams","DetailsResource",function(a,b,e,g){b.tableName=!1;b.isTable=!1;g.get({id:e.id},function(a){b.details=a;b.schemas=a;b.tableName=a.values.name;b.isTable="Table"===a.typeName;b.onActivate("io")});b.isNumber=angular.isNumber;b.isString=angular.isString;b.onActivate=function(a){b.$broadcast("render-lineage",{type:a,tableName:b.tableName})};b.goBack=function(){a.history.back()}}]);angular.module("dgc.details").factory("DetailsResource",["$resource",function(a){return a("/api/atlas/entity/:id",{},{get:{method:"GET",transformResponse:function(a){if(a)return angular.fromJson(a.definition)},responseType:"json"},saveTag:{method:"POST",url:"/api/atlas/entity/:id/traits"}})}]);angular.module("dgc.details").config(["$stateProvider",function(a){a.state("details",{url:"/details/:id",templateUrl:"/modules/details/views/details.html"})}]);angular.module("dgc.home").controller("HeaderController",["$scope","$modal",function(a,b){a.menu=[{title:"Tags",state:"tags"}];a.isCollapsed=!0;a.isLoggedIn=function(){return!0};a.ShowAbout=function(){b.open({animation:!0,templateUrl:"/modules/about/views/about.html",controller:"AboutController",size:"lg"})}}]);angular.module("dgc.lineage").controller("LineageController",["$element","$scope","$state","$stateParams","lodash","LineageResource","d3","DetailsResource","$q",function(a,b,e,g,h,q,c,m,f){function d(a,c){q.get({tableName:a.tableName,type:a.type},function(a){if(h.isEmpty(a.results.values.vertices))b.requested=!1;else l(a.results.values.edges,a.results.values.vertices).then(function(d){v=d;b.lineageData=t(a.results);c&&s()}).on("dblclick",function(a){e.go("details",{id:a.guid})})})}function l(a,b){var c=
[],d=f.defer(),H;for(H in a)b.hasOwnProperty(H)||c.push(m.get({id:H}).$promise);f.all(c).then(function(a){d.resolve(a)});return d.promise}function s(){B(b.lineageData,{eleObj:a,element:a[0],height:b.height,width:b.width});b.rendered=!0}function t(a){function b(a){var d,f,h;if(e.hasOwnProperty(a))d=e[a].values.name,f=e[a].values.vertexId.values.typeName;else{var k=c(a);"undefined"!==typeof k?(d=k.name,f=k.typeName,h=k.tip):f=d="Load Process"}d={guid:a,name:d,type:f,tip:h};g.hasOwnProperty(a)||(g[a]=
d);return g[a]}function c(a){var b=[];angular.forEach(v,function(c){c.id.id===a&&(b.name=c.values.name,b.typeName=c.typeName,b.tip=c.values.queryText)});return b}function d(a,c){a.forEach(function(a){a=b(a);c.children=c.children||[];c.children.push(a);a.parent=c.guid})}var f=a.values.edges,e=a.values.vertices,g={},l;for(l in f){a=f[l];var q=b(l);d(a,q)}return h.find(g,function(a){return!a.hasOwnProperty("parent")})}function B(a,d){function f(a,b,c){if(a&&(b(a),a=c(a)))for(var d=a.length,k=0;k<d;k++)f(a[k],
b,c)}function e(){r.sort(function(a,b){return b.name.toLowerCase()<a.name.toLowerCase()?1:-1})}function g(a){a._children&&(a.children=a._children,a.children.forEach(g),a._children=null)}function h(a){var b=10===w?y.scale():.4,d=-a.y0;a=-a.x0;d=d*b+150;a=a*b+z/2;c.select("g").transition().duration(750).attr("transform","translate("+d+","+a+")scale("+b+")");y.scale(b);y.translate([d,a])}function l(a){c.event.defaultPrevented||(a.children?(a._children=a.children,a.children=null):a._children&&(a.children=
a._children,a._children=null),q(a))}function q(a){var c=[1],d=function(a,b){b.children&&0<b.children.length&&(c.length<=a+1&&c.push(0),c[a+1]+=b.children.length,b.children.forEach(function(b){d(a+1,b)}))};d(0,n);r=r.nodeSize([50,100]);var k=r.nodes(n).reverse(),f=r.links(k);k.forEach(function(a){if(1<c.length&&10===w)for(var b=0;b<c.length;b++)if(4<c[b]){w=70;break}b=C;10===w&&(b=20);a.y=a.depth*b*w});u=x.selectAll("g.node").data(k,function(a){return a.id||(a.id=++B)});var e=u.enter().append("g").call(G).attr("class",
"node").attr("transform",function(){return"translate("+a.y0+","+a.x0+")"}).on("click",l);e.append("image").attr("class","nodeImage").attr("xlink:href",function(a){return"Table"===a.type?"../img/tableicon.png":"../img/process.png"}).on("mouseover",function(a){A.show(a)}).on("mouseout",function(a){A.hide(a)}).attr("x","-18px").attr("y","-18px").attr("width","34px").attr("height","34px");e.append("text").attr("x",function(a){return a.children||a._children?-10:10}).attr("dx",function(a){return a.children?
50:-50}).attr("dy",-24).attr("class","place-label").attr("text-anchor",function(a){return a.children||a._children?"end":"start"}).text(function(a){var b=15<a.name.length?a.name.substring(0,15)+"...":a.name;$(this).attr("title",a.name);return b}).style("fill-opacity",0);u.select("text").attr("x",function(a){return a.children||a._children?-10:10}).attr("text-anchor",function(a){return a.children||a._children?"end":"start"}).text(function(a){var b=15<a.name.length?a.name.substring(0,15)+"...":a.name;
$(this).attr("title",a.name);return b});u.select("image.nodeImage").attr("r",4.5).attr("xlink:href",function(a){return a._children?"Table"===a.type?"../img/tableicon1.png":"../img/process1.png":"Table"===a.type?"../img/tableicon.png":"../img/process.png"});u.transition().duration(750).attr("transform",function(a){return"translate("+a.y+","+a.x+")"}).select("text").style("fill-opacity",1);e=u.exit().transition().duration(750).attr("transform",function(){return"translate("+a.y+","+a.x+")"}).remove();
e.select("circle").attr("r",0);e.select("text").style("fill-opacity",0);f=x.selectAll("path.link").data(f,function(a){return a.target.id});f.enter().insert("path","g").attr("class","link").style("stroke","green").attr("d",function(){var b={x:a.x0,y:a.y0};return D({source:b,target:b})});f.transition().duration(750).attr("d",D);f.exit().transition().duration(750).attr("d",function(){var b={x:a.x,y:a.y};return D({source:b,target:b})}).remove();k.forEach(function(a){a.x0=a.x;a.y0=a.y});"inputs"===b.type?
f.attr("marker-start","url(#input-arrow)"):f.attr("marker-end","url(#arrow)")}var m=c.select(d.element),s=Math.max(d.width,960),t=Math.max(d.height,500),I=0,C=0,k=null,p=null,G=null,E=null,v=null,A=null,u=null,B=0,n,w=10,s=s-15,z=t,r=c.layout.tree().nodeSize([100,200]);d.eleObj.find(".graph").html("");d.eleObj.find("svg").remove();var D=c.svg.diagonal().projection(function(a){return[a.y,a.x]});f(a,function(a){I++;C=Math.max(a.name.length,C)},function(a){return a.children&&0<a.children.length?a.children:
null});e();var y=c.behavior.zoom().scaleExtent([.1,3]).on("zoom",function(){x.attr("transform","translate("+c.event.translate+")scale("+c.event.scale+")")}),A=c.tip().attr("class","d3-tip").html(function(a){return'<pre class="alert alert-success">'+a.name+"</pre>"}),m=m.append("svg").attr("width",s).attr("height",z).attr("class","overlay").call(y).call(A),G=c.behavior.drag().on("dragstart",function(a){a!==n&&(r.nodes(a),c.event.sourceEvent.stopPropagation())}).on("dragend",function(a){a!==n&&(E=this,
k&&(a=p.parent.children.indexOf(p),-1<a&&p.parent.children.splice(a,1),"undefined"!==typeof k.children||"undefined"!==typeof k._children?"undefined"!==typeof k.children?k.children.push(p):k._children.push(p):(k.children=[],k.children.push(p)),g(k),e()),k=null,c.selectAll(".ghostCircle").attr("class","ghostCircle"),c.select(E).attr("class","node"),c.select(E).select(".ghostCircle").attr("pointer-events",""),a=[],null!==p&&null!==k&&(a=[{source:{x:k.y0,y:k.x0},target:{x:p.y0,y:p.x0}}]),a=x.selectAll(".templink").data(a),
a.enter().append("path").attr("class","templink").attr("d",c.svg.diagonal()).attr("pointer-events","none"),a.attr("d",c.svg.diagonal()),a.exit().remove(),null!==p&&(q(n),h(p),p=null))});m.append("svg:defs").append("svg:marker").attr("id","arrow").attr("viewBox","0 0 10 10").attr("refX",22).attr("refY",5).attr("markerUnits","strokeWidth").attr("markerWidth",6).attr("markerHeight",9).attr("orient","auto").append("svg:path").attr("d","M 0 0 L 10 5 L 0 10 z");m.append("svg:defs").append("svg:marker").attr("id",
"input-arrow").attr("viewBox","0 0 10 10").attr("refX",-15).attr("refY",5).attr("markerUnits","strokeWidth").attr("markerWidth",6).attr("markerHeight",9).attr("orient","auto").append("svg:path").attr("d","M -2 5 L 8 0 L 8 10 z");var x=m.append("g").attr("transform","translate(120 ,"+t/2+")");n=a;n.x0=z/2;n.y0=0;q(n);h(n);t=r.nodes(n).filter(function(a){return"cluster"===a.name})[0];m=r.nodes(n).filter(function(a){return"JSONConverter"===a.name})[0];v=[{parent:t,child:m}];v.forEach(function(){x.append("path",
"g")})}var v=[];b.type=a.parent().attr("data-table-type");b.requested=!1;b.height=a[0].offsetHeight;b.width=a[0].offsetWidth;b.onReset=function(){B(b.lineageData,{eleObj:a,element:a[0],height:b.height,width:b.width})};b.$on("render-lineage",function(a,c){c.type===b.type&&(b.lineageData?s():b.requested||(d(c,!0),b.requested=!0))})}]);angular.module("dgc.lineage").factory("LineageResource",["$resource",function(a){return a("/api/atlas/lineage/hive/table/:tableName/:type/graph",{})}]);angular.module("dgc.lineage").controller("Lineage_ioController",["$element","$scope","$state","$stateParams","lodash","LineageResource","d3","DetailsResource","$q",function(a,b,e,g,h,q,c,m,f){function d(a){var b={};$.each(a,function(a,c){for(var d=0;d<c.length;d++)b[c[d]]=b[c[d]]||[],b[c[d]]=[a]});return b}function l(a,c){q.get({tableName:a.tableName,type:"outputs"},function(f){q.get({tableName:a.tableName,type:"inputs"},function(a){a.results.values.edges=d(a.results.values.edges);angular.forEach(a.results.values.edges,
function(b,c){angular.forEach(f.results.values.edges,function(d,e){c===e&&(angular.forEach(d,function(a){b.push(a)}),a.results.values.edges[c]=b,f.results.values.edges[c]=b)})});angular.extend(a.results.values.edges,f.results.values.edges);angular.extend(a.results.values.vertices,f.results.values.vertices);h.isEmpty(a.results.values.vertices)?b.requested=!1:s(a.results.values.edges,a.results.values.vertices).then(function(d){F=d;b.lineageData=B(a.results);c&&t()})})})}function s(a,b){var c=[],d=f.defer(),
e;for(e in a)b.hasOwnProperty(e)||c.push(m.get({id:e}).$promise);f.all(c).then(function(a){d.resolve(a)});return d.promise}function t(){v(b.lineageData,{eleObj:a,element:a[0],height:b.height,width:b.width});b.rendered=!0}function B(a){function b(a){var d,f,h;if(e.hasOwnProperty(a))d=e[a].values.name,f=e[a].values.vertexId.values.typeName;else{var l=c(a);"undefined"!==typeof l?(d=l.name,f=l.typeName,h=l.tip):f=d="Load Process"}d={guid:a,name:d,type:f,tip:h};g.hasOwnProperty(a)||(g[a]=d);return g[a]}
function c(a){var b=[];angular.forEach(F,function(c){c.id.id===a&&(b.name=c.values.name,b.typeName=c.typeName,b.tip=c.values.queryText)});return b}function d(a,c){a.forEach(function(a){a=b(a);c.children=c.children||[];c.children.push(a);a.parent=c.guid})}var f=a.values.edges,e=a.values.vertices,g={},h;for(h in f){a=f[h];var m=b(h);d(a,m)}var l={name:"root",guid:"root",children:[]};angular.forEach(g,function(a){a.hasOwnProperty("parent")||l.children.push(a)});return l}function v(a,d){function f(a,
b,c){if(a&&(b(a),a=c(a)))for(var d=a.length,e=0;e<d;e++)f(a[e],b,c)}function g(){r.sort(function(a,b){return b.name.toLowerCase()<a.name.toLowerCase()?1:-1})}function l(a){a._children&&(a.children=a._children,a.children.forEach(l),a._children=null)}function m(a){var b=10===w?y.scale():.4,d=-a.y0;a=-a.x0;d=d*b-130;a=a*b+z/2;c.select("g").transition().duration(750).attr("transform","translate("+d+","+a+")scale("+b+")");y.scale(b);y.translate([d,a])}function q(a){var c=[1],d=function(a,b){b.children&&
0<b.children.length&&(c.length<=a+1&&c.push(0),c[a+1]+=b.children.length,b.children.forEach(function(b){d(a+1,b)}))};d(0,n);r=r.nodeSize([50,100]);var f=r.nodes(n).reverse(),f=h.uniq(f,"guid");h.each(f,function(a,b){var c=h.where(f,{depth:a.depth}),d=h.indexOf(c,a),c=z/c.length;f[b].x=c/2+c*d});var g=r.links(f);h.each(g,function(a,b){g[b].target=h.find(f,{guid:a.target.guid})});f.forEach(function(a){if(1<c.length&&10===w)for(var b=0;b<c.length;b++)if(4<c[b]){w=70;break}b=C;10===w&&(b=20);a.y=a.depth*
b*w});u=x.selectAll("g.node").data(f,function(a){return a.id||(a.id=++J)});var l=u.enter().append("g").call(G).attr("class",function(a){return"root"===a.guid?"hide":""}).classed("node",!0).attr("transform",function(){return"translate("+a.y0+","+a.x0+")"});l.append("image").attr("class","nodeImage").attr("xlink:href",function(a){return"Table"===a.type?"../img/tableicon.png":"../img/process.png"}).on("mouseover",function(a){A.show(a)}).on("dblclick",function(a){e.go("details",{id:a.guid})}).on("mouseout",
function(a){A.hide(a)}).attr("x","-18px").attr("y","-18px").attr("width","34px").attr("height","34px");l.append("text").attr("x",function(a){return a.children||a._children?-10:10}).attr("dx",function(a){return a.children?50:-50}).attr("dy",-24).attr("class","place-label").attr("text-anchor",function(a){return a.children||a._children?"end":"start"}).text(function(a){var b=15<a.name.length?a.name.substring(0,15)+"...":a.name;$(this).attr("title",a.name);return b}).style("fill-opacity",0);u.select("text").attr("x",
function(a){return a.children||a._children?-10:10}).attr("text-anchor",function(a){return a.children||a._children?"end":"start"}).text(function(a){var b=15<a.name.length?a.name.substring(0,15)+"...":a.name;$(this).attr("title",a.name);return b});u.select("image.nodeImage").attr("r",4.5).attr("xlink:href",function(a){return a._children?"Table"===a.type?"../img/tableicon1.png":"../img/process1.png":"Table"===a.type?"../img/tableicon.png":"../img/process.png"});u.transition().duration(750).attr("transform",
function(a){return"translate("+a.y+","+a.x+")"}).select("text").style("fill-opacity",1);l=u.exit().transition().duration(750).attr("transform",function(){return"translate("+a.y+","+a.x+")"}).remove();l.select("circle").attr("r",0);l.select("text").style("fill-opacity",0);l=x.selectAll("path.link").data(g);l.enter().insert("path","g").attr("class",function(a){return"root"===a.source.guid?"hide":""}).classed("link",!0).style("stroke","green").attr("d",function(){var b={x:a.x0,y:a.y0};return D({source:b,
target:b})});l.transition().duration(750).attr("d",D);l.exit().transition().duration(750).attr("d",function(){var b={x:a.x,y:a.y};return D({source:b,target:b})}).remove();f.forEach(function(a){a.x0=a.x;a.y0=a.y});"inputs"===b.type?l.attr("marker-start","url(#input-arrow)"):l.attr("marker-end","url(#arrow)")}var s=c.select(d.element),t=Math.max(d.width,1100),v=Math.max(window.innerHeight-400,500),B=0,C=0,k=null,p=null,G=null,E=null,F=null,A=null,u=null,J=0,n,w=10,t=t-15,z=v,r=c.layout.tree().size([z,
t]);d.eleObj.find(".graph").html("");d.eleObj.find("svg").remove();var D=c.svg.diagonal().projection(function(a){return[a.y,a.x]});f(a,function(a){B++;C=Math.max(a.name.length,C)},function(a){return a.children&&0<a.children.length?a.children:null});g();var y=c.behavior.zoom().scaleExtent([.1,3]).on("zoom",function(){x.attr("transform","translate("+c.event.translate+")scale("+c.event.scale+")")}),A=c.tip().attr("class","d3-tip").html(function(a){return'<pre class="alert alert-success">'+a.name+"</pre>"}),
s=s.append("svg").attr("width",t).attr("height",z).attr("class","overlay").call(y).on("dblclick.zoom",function(){return null}).call(A),G=c.behavior.drag().on("dragstart",function(a){a!==n&&(r.nodes(a),c.event.sourceEvent.stopPropagation())}).on("dragend",function(a){a!==n&&(E=this,k&&(a=p.parent.children.indexOf(p),-1<a&&p.parent.children.splice(a,1),"undefined"!==typeof k.children||"undefined"!==typeof k._children?"undefined"!==typeof k.children?k.children.push(p):k._children.push(p):(k.children=
[],k.children.push(p)),l(k),g()),k=null,c.selectAll(".ghostCircle").attr("class","ghostCircle"),c.select(E).attr("class","node"),c.select(E).select(".ghostCircle").attr("pointer-events",""),a=[],null!==p&&null!==k&&(a=[{source:{x:k.y0,y:k.x0},target:{x:p.y0,y:p.x0}}]),a=x.selectAll(".templink").data(a),a.enter().append("path").attr("class","templink").attr("d",c.svg.diagonal()).attr("pointer-events","none"),a.attr("d",c.svg.diagonal()),a.exit().remove(),null!==p&&(q(n),m(p),p=null))});s.append("svg:defs").append("svg:marker").attr("id",
"arrow").attr("viewBox","0 0 10 10").attr("refX",22).attr("refY",5).attr("markerUnits","strokeWidth").attr("markerWidth",6).attr("markerHeight",9).attr("orient","auto").append("svg:path").attr("d","M 0 0 L 10 5 L 0 10 z");s.append("svg:defs").append("svg:marker").attr("id","input-arrow").attr("viewBox","0 0 10 10").attr("refX",-15).attr("refY",5).attr("markerUnits","strokeWidth").attr("markerWidth",6).attr("markerHeight",9).attr("orient","auto").append("svg:path").attr("d","M -2 5 L 8 0 L 8 10 z");
var x=s.append("g").attr("transform","translate(0,0)");n=a;n.x0=t/2;n.y0=z/2;q(n);m(n);b.requested=!1;s=r.nodes(n).filter(function(a){return"cluster"===a.name})[0];v=r.nodes(n).filter(function(a){return"JSONConverter"===a.name})[0];F=[{parent:s,child:v}];F.forEach(function(){x.append("path","g")})}var F=[];b.type=a.parent().attr("data-table-type");b.requested=!0;b.height=a[0].offsetHeight;b.width=a[0].offsetWidth;b.onReset=function(){v(b.lineageData,{eleObj:a,element:a[0],height:b.height,width:b.width})};
b.$on("render-lineage",function(a,c){c.type===b.type&&(b.lineageData?t():b.requested&&("io"===b.type&&console.log(b.type),l(c,!0)))})}]);angular.module("dgc.navigation").controller("NavigationController",["$scope","NavigationResource",function(a,b){a.leftnav=b.get();a.updateVar=function(b){a.$$prevSibling.query=angular.element(b.target).text()}}]);angular.module("dgc.navigation").factory("NavigationResource",["$resource",function(a){return a("/api/atlas/types?type=TRAIT",{},{get:{method:"GET",responseType:"json",isArray:!0,transformResponse:function(a){var e=[];angular.forEach(a&&a.results,function(a){e.push(a)});return e}}})}]);angular.module("dgc.system.notification").controller("NotificationController",["$scope","NotificationService",function(a,b){a.getNotifications=b.getAll;a.close=function(a){b.close(a)}}]);angular.module("dgc.system.notification").service("NotificationService",["$timeout","lodash","ColorCoding",function(a,b,e){var g=[],h={timeout:2E3,getAll:function(){return g},reset:function(){g=[]},close:function(a){b.remove(g,a)}};b.each(e,function(e,c){h[c]=function(c,f){var d=c;b.isString(c)&&(d={message:c});d.message=d.msg||d.message;delete d.msg;d.type=e;d.timeout=b.isUndefined(f)?b.isUndefined(d.timeout)?!0:d.timeout:f;g.push(d);d.timeout&&a(function(){h.close(d)},angular.isNumber(d.timeout)?
d.timeout:h.timeout)}});return h}]);angular.module("dgc.search").controller("SearchController",["$scope","$location","$http","$state","$stateParams","lodash","SearchResource","NotificationService",function(a,b,e,g,h,q,c,m){a.results=[];a.resultCount=0;a.isCollapsed=!0;a.currentPage=1;a.itemsPerPage=10;a.filteredResults=[];a.resultRows=[];a.setPage=function(b){a.currentPage=b};a.search=function(b){a.results=[];m.reset();a.limit=4;a.searchMessage="load-gif";a.$parent.query=b;c.search({query:b},function(b){a.resultCount=b.count;a.results=
b.results;a.resultRows=a.results;a.totalItems=a.resultCount;a.transformedResults={};a.dataTransitioned=!1;b.results.dataType&&0===b.results.dataType.typeName.indexOf("__")?(a.dataTransitioned=!0,angular.forEach(b.results.dataType.attributeDefinitions,function(b){"__IdType"===b.dataTypeName&&(a.searchKey=b.name)}),a.transformedResults=a.filterResults()):a.transformedResults=a.resultRows;a.searchMessage=a.results?a.resultCount+" results matching your search query "+a.query+" were found":"0 results matching your search query "+
a.query+" were found";a.$watch("currentPage + itemsPerPage",function(){var b=(a.currentPage-1)*a.itemsPerPage,c=b+a.itemsPerPage;a.transformedResults&&(a.filteredResults=a.transformedResults.slice(b,c));a.pageCount=function(){return Math.ceil(a.resultCount/a.itemsPerPage)};1>a.results.length&&m.error("No Result found",!1)})},function(b){a.searchMessage="0 results matching your search query "+a.query+" were found";m.error("Error occurred during executing search query, error status code = "+b.status+
", status text = "+b.statusText,!1)});g.go("search",{query:b},{location:"replace"})};a.filterResults=function(){var b=[];angular.forEach(a.resultRows,function(c){b.push(c[a.searchKey])});return b};a.doToggle=function(a,b){this.isCollapsed=!b};a.filterSearchResults=function(b){var c={},e=0;b=q.omit(b,["name","description","guid"]);angular.forEach(b,function(a,b){"object"!==typeof a&&0>b.indexOf("$$")&&(c[b]=a,e++)});a.keyLength=e;return c};a.searchQuery=b.search();a.query=b.search().query;a.query&&
a.search(a.query)}]);angular.module("dgc.search").directive("myDirective",function(){return{restrict:"EA",template:'<a href="javascript: void(0);" button-toggle toggle="isCollapsed" class="show-more" ng-click="isCollapsed = !isCollapsed">..show more</a>',link:function(a){a.isCollapsed=!0;console.log(a.isCollapsed)},transclude:!0,scope:{}}});angular.module("dgc.search").factory("SearchResource",["$resource",function(a){return a("/api/atlas/discovery/search/",{},{search:{method:"GET",responseType:"json",transformResponse:function(a){return a}}})}]);angular.module("dgc.search").config(["$stateProvider",function(a){a.state("search",{url:"/search?query",templateUrl:"/modules/search/views/search.html",controller:"SearchController"})}]);angular.module("dgc.tags.definition").controller("DefinitionTagsController",["$scope","$resource","$state","$stateParams","lodash","AttributeDefinition","TagClasses","TagsResource","NotificationService",function(a,b,e,g,h,q,c,m,f){a.categoryList=c;a.category="TRAIT";a.tagModel={typeName:null,attributeDefinitions:[]};a.addAttribute=function(){a.tagModel.attributeDefinitions.push(q.getModel())};a.categoryChange=function(){a.categoryInst=c[a.category].clearTags()};a.save=function(b){a.savedTag=null;
b.$valid&&(a.categoryInst=c[a.category],a.categoryInst.clearTags().addTag(a.tagModel),f.reset(),a.saving=!0,m.save(a.categoryInst.toJson()).$promise.then(function(){f.info('"'+a.tagModel.typeName+'" has been created',!1);return m.get({id:a.tagModel.typeName}).$promise}).then(function(b){a.savedTag=JSON.parse(b.definition)}).catch(function(a){f.error(a.data.error,!1)}).finally(function(){a.saving=!1}))}}]);angular.module("dgc.tags.definition").service("AttributeDefinition",function(){this.getModel=function(){return{name:null,dataTypeName:"string",multiplicity:"optional",isComposite:!1,isUnique:!1,isIndexable:!0,reverseAttributeName:null}}});angular.module("dgc.tags.instance").controller("CreateTagController",["$scope","DetailsResource","$modalInstance","typesList","lodash","TagsResource","$stateParams","$rootScope","TagClasses","NotificationService",function(a,b,e,g,h,q,c,m,f,d){g&&(a.typesList=g);a.categoryList=f;a.category="TRAIT";a.getAttributeDefinations=function(){q.get({id:a.selectedType},function(b){var c=f[a.category].instanceInfo();c&&(b=angular.fromJson(b.definition)[c][0])&&(a.propertiesList={},a.isRequired={},h.each(b.attributeDefinitions,
function(b){a.propertiesList[b.name]="";a.isRequired[b.name]=b.isRequired}))})};a.ok=function(f){f.$valid&&b.saveTag({id:c.id},{jsonClass:"org.apache.atlas.typesystem.json.InstanceSerialization$_Struct",typeName:a.selectedType,values:a.propertiesList}).$promise.then(function(){m.$broadcast("refreshResourceData");d.info('Tag "'+a.selectedType+'" has been added to entity',!0);e.close(!0)}).catch(function(b){a.isError=!0;a.error=b.data.error})};a.cancel=function(){e.dismiss("cancel")}}]);angular.module("dgc.tags.instance").controller("InstanceTagController",["$scope","DetailsResource","$stateParams","$state",function(a,b,e,g){function h(){b.get({id:e.id},function(b){a.traitsList=b.traitNames})}a.id=e.id;a.openAddTag=function(){g.go("addTag",{id:a.id})};h();a.$on("refreshResourceData",h)}]);angular.module("dgc.tags").factory("TagClasses",["lodash",function(a){function b(b){return a.merge({superTypes:[],typeName:null,attributeDefinitions:[]},b)}function e(e,c){this.tags=[];this.id=e;this.name=c;this.addTag=function(e){e=new b(a.merge({hierarchicalMetaTypeName:c},e));this.tags.push(e);return this};this.clearTags=function(){this.tags=[];return this};this.toJson=function(){var b=this.id.toLowerCase()+"Types",c={};a.forEach(g,function(a,b){c[b.toLowerCase()+"Types"]=[]});c[b]=this.tags;return c};
this.instanceInfo=function(){return h[e]}}var g={ENUM:"org.apache.atlas.typesystem.types.EnumType",TRAIT:"org.apache.atlas.typesystem.types.TraitType",STRUCT:"org.apache.atlas.typesystem.types.StructType",CLASS:"org.apache.atlas.typesystem.types.ClassType"},h={ENUM:"enumTypes",STRUCT:"structTypes",TRAIT:"traitTypes",SUPER:"superTypes"};return a.chain(g).map(function(a,b){return new e(b,a)}).indexBy("id").value()}]);angular.module("dgc.tags").factory("TagsResource",["$resource",function(a){return a("/api/atlas/types/:id",{},{query:{method:"GET",transformResponse:function(a){var e=[];a&&angular.forEach(a.results,function(a){e.push({text:a})});return e},responseType:"json",isArray:!0}})}]);angular.module("dgc.tags").config(["$stateProvider",function(a){a.state("tags",{url:"/tags",templateUrl:"/modules/tags/definition/views/add.html"});a.state("addTag",{parent:"details",onEnter:["$stateParams","$state","$modal","NavigationResource",function(a,e,g,h){g.open({templateUrl:"/modules/tags/instance/views/createTag.html",controller:"CreateTagController",windowClass:"create-tag-entity",resolve:{typesList:function(){return h.get().$promise}}}).result.finally(function(){e.go("^")})}]})}]);angular.element(document).ready(function(){"#_=_"===window.location.hash&&(window.location.hash="#!");angular.bootstrap(document,["dgc"],{strictDi:!0})});
